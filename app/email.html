<!DOCTYPE html>
<html lang="hu">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>JELENTKEZZ ITT</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700;800&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg: #ffffff00;
        --card: #ffffff;
        --accent: #000;
        --muted: #7a8794;
        --accent-2: #000;
        --input-border: #c3c3c3;
        --radius: 8px;
        --label-size: 13px;
        --error: #ff4d4d;
      }

      html,
      body {
        height: 100%;
        margin: 0;
        font-family: "Open Sans", Arial, sans-serif;
        background: var(--bg);
        color: var(--accent);
      }

      h1 {
        font-size: 3rem;
        text-align: center;
        color: #0da650;
      }

      @media (max-width: 768px) {
        h1 {
          font-size: 2.2rem;
        }
      }

      @media (max-width: 480px) {
        h1 {
          font-size: 1.8rem;
        }
      }

      @media (max-width: 480px) {
        .wrap {
          padding: 16px;
        }
        .control {
          padding: 4px 8px;
        }
        input,
        textarea,
        select {
          padding: 6px 0;
        }
      }

      .wrap {
        width: 100%;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
        margin-top: 20px;
        margin-bottom: 20px;
        padding: 20px;
        background: var(--card);
        border-radius: 14px;
        box-shadow: 0 8px 30px rgba(10, 20, 40, 0.06);
        box-sizing: border-box;
      }

      .grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 14px;
        align-items: stretch;
      }

      .grid > div {
        display: flex;
        flex-direction: column;
      }

      .grid > div .control {
        margin-top: auto;
      }

      .headline {
        text-transform: uppercase;
        text-align: center;
        margin: 12px;
        margin-bottom: 50px;
        font-weight: 950;
        font-size: 32px;
        line-height: 1.2;
      }

      .paragraph {
        text-transform: uppercase;
        text-align: center;
        margin-bottom: 40px;
        font-weight: 950;
        font-size: 24px;
        line-height: 1.2;
      }

      label.field-label {
        display: block;
        font-weight: 700;
        font-size: var(--label-size);
        margin-bottom: 8px;
        color: var(--accent);
      }

      .control {
        background: #fff;
        border-radius: 10px;
        padding: 5px 10px;
        border: 1px solid var(--input-border);
        display: flex;
        align-items: center;
        gap: 10px;
      }

      input,
      textarea,
      select {
        width: 100%;
        border: 0;
        outline: 0;
        font-size: 15px;
        background: transparent;
        padding: 8px 0;
        font-family: inherit;
        appearance: none;
        min-height: 18px;
      }

      textarea {
        resize: vertical;
        padding-top: 2px;
        padding-bottom: 2px;
      }

      .full {
        grid-column: 1 / -1;
      }

      @media (max-width: 720px) {
        .grid {
          grid-template-columns: 1fr;
        }
      }

      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        background: var(--accent-2);
        color: #fff;
        border: 0;
        padding: 12px 6rem;
        border-radius: 10px;
        font-weight: 950;
        cursor: pointer;
        font-size: 18px;
        margin-top: 14px;
        background-color: #0da650;
      }

      .success {
        display: none;
        text-align: center;
        margin-top: 14px;
        color: var(--accent);
        font-size: 18px;
      }
      .visible {
        display: block;
      }
      .error-border {
        border: 1px solid var(--error) !important;
      }
      .popup {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        background: var(--card);
        border-radius: var(--radius);
        padding: 24px 32px;
        box-shadow: 0 8px 30px rgba(10, 20, 40, 0.2);
        text-align: center;
        font-weight: 700;
        font-size: 16px;
        color: var(--error);
        z-index: 999;
        transition: transform 0.3s ease, opacity 0.3s ease;
        opacity: 0;
        text-transform: uppercase;
      }
      .popup.visible {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
      }

      .popup button {
        margin-top: 16px;
        background: var(--accent-2);
        color: #fff;
        border: 0;
        padding: 8px 20px;
        border-radius: var(--radius);
        cursor: pointer;
        font-weight: 700;
      }

      @media (max-width: 480px) {
        body {
          padding-left: 0;
          padding-right: 0;
        }
        .wrap {
          width: 100%;
          max-width: 100%;
          padding-left: 12px;
          padding-right: 12px;
        }
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <h1 class="headline">JELENTKEZZ ITT</h1>
      <form id="contactForm" autocomplete="off" novalidate>
        <input type="hidden" id="sheetName" name="sheetName" value="CLEANER NIGHTSHIFT BUDAPEST" />
        <input type="hidden" id="recipientEmail" name="recipientEmail" value="hiring@simonsburger.hu" />
        <input type="hidden" id="submissionId" name="submissionId" value="" />

        <div class="grid">
          <div>
            <label class="field-label" for="firstname">KERESZTNÉV *</label>
            <div class="control">
              <input id="firstname" name="firstname" type="text" required />
            </div>
          </div>
          <div>
            <label class="field-label" for="lastname">VEZETÉKNÉV *</label>
            <div class="control">
              <input id="lastname" name="lastname" type="text" required />
            </div>
          </div>
          <div>
            <label class="field-label" for="email">EMAIL *</label>
            <div class="control">
              <input id="email" name="email" type="email" required />
            </div>
          </div>
          <div>
            <label class="field-label" for="phone">TELEFON *</label>
            <div class="control">
              <input id="phone" name="phone" type="tel" required />
            </div>
          </div>
          <div>
            <label class="field-label" for="experience">VAN VENDÉGLÁTÓS TAPASZTALOD? *</label>
            <div class="control">
              <select id="experience" name="experience" required>
                <option value="">Válassz...</option>
                <option value="yes">Igen</option>
                <option value="no">Nem</option>
              </select>
            </div>
          </div>
          <div>
            <label class="field-label" for="birthdate">MIKOR SZÜLETTÉL? *</label>
            <div class="control">
              <input id="birthdate" name="birthdate" type="date" required />
            </div>
          </div>
          <div>
            <label class="field-label" for="student">25 ÉV ALATTI NAPPALI TAGOZATOS DIÁK VAGY? *</label>
            <div class="control">
              <select id="student" name="student" required>
                <option value="">Válassz...</option>
                <option value="yes">Igen</option>
                <option value="no">Nem</option>
              </select>
            </div>
          </div>
          <div>
            <label class="field-label" for="social">INSTAGRAM/FACEBOOK LINK</label>
            <div class="control">
              <input id="social" name="social" type="url" placeholder="https://" />
            </div>
          </div>
          <div>
            <label class="field-label" for="daysPerWeek">HETI HÁNY NAPOT TUDNÁL VÁLLALNI? *</label>
            <div class="control">
              <select id="daysPerWeek" name="daysPerWeek" required>
                <option value="">Válassz...</option>
                <option value="1">1 nap</option>
                <option value="2">2 nap</option>
                <option value="3">3 nap</option>
                <option value="4">4 nap</option>
                <option value="5">5 nap</option>
                <option value="6">6 nap</option>
                <option value="7">7 nap</option>
              </select>
            </div>
          </div>
          <div>
            <label class="field-label" for="weekend">HÉTVÉGÉT IS TUDSZ VÁLLALNI? *</label>
            <div class="control">
              <select id="weekend" name="weekend" required>
                <option value="">Válassz...</option>
                <option value="yes">Igen</option>
                <option value="no">Nem</option>
              </select>
            </div>
          </div>

          <div class="full">
            <label class="field-label" for="workHistory">NÉHÁNY MONDATBAN FOGLALD ÖSSZE, HOGY HOL DOLGOZTÁL *</label>
            <div class="control">
              <textarea
                id="workHistory"
                name="workHistory"
                rows="6"
                required
              ></textarea>
            </div>
          </div>

          <div
            class="full"
            style="display: flex; flex-direction: column; align-items: center"
          >
            <button id="submitBtn" class="btn" type="submit">MEHET</button>
            <div id="success" class="success">SIKERES JELENTKEZÉS</div>
          </div>
        </div>

        <div id="popup" class="popup">
          <br />
          Kimaradt kötelező mezők!<br /><br />
          <button type="button" onclick="closePopup()">OK</button>
        </div>
      </form>
    </div>

    <iframe
      name="hidden_iframe"
      id="hidden_iframe"
      style="display: none"
      scrolling="no"
    ></iframe>

    <script>
      const WEB_APP_URL =
        "https://script.google.com/macros/s/AKfycbxzkXQFZPXOQJTftaW72-LUHfmCb9Oeo1-dwQ1jTx_uX08izQz4Bnvzp8c30fQK-nsr/exec";
      const form = document.getElementById("contactForm");
      const popup = document.getElementById("popup");
      const msgEl = document.getElementById("success");
      const submitBtn = document.getElementById("submitBtn");

      function showPopup() {
        popup.classList.add("visible");
      }
      function closePopup() {
        popup.classList.remove("visible");
      }

      function highlightRequiredFields() {
        let valid = true;
        document.querySelectorAll("[required]").forEach((el) => {
          const control = el.closest(".control");
          if (!control) return;
          if (
            !el.value ||
            (typeof el.value === "string" && el.value.trim() === "")
          ) {
            control.classList.add("error-border");
            valid = false;
          } else {
            control.classList.remove("error-border");
          }
        });
        if (!valid) showPopup();
        return valid;
      }

      function gatherData() {
        return {
          submissionId: document.getElementById("submissionId").value.trim(),
          sheetName: document.getElementById("sheetName").value.trim(),
          firstname: document.getElementById("firstname").value.trim(),
          lastname: document.getElementById("lastname").value.trim(),
          email: document.getElementById("email").value.trim(),
          phone: document.getElementById("phone").value.trim(),
          experience: document.getElementById("experience").value,
          birthdate: document.getElementById("birthdate").value,
          student: document.getElementById("student").value,
          social: document.getElementById("social").value.trim(),
          daysPerWeek: document.getElementById("daysPerWeek").value,
          weekend: document.getElementById("weekend").value,
          workHistory: document.getElementById("workHistory").value.trim()
        };
      }

      function showLoading() {
        submitBtn.textContent = "KÜLDÉS...";
        submitBtn.disabled = true;
      }
      function hideLoading() {
        submitBtn.textContent = "MEHET";
        submitBtn.disabled = false;
      }
      function showSuccess() {
        msgEl.classList.add("visible");
        form.reset();
        hideLoading();
        setTimeout(() => msgEl.classList.remove("visible"), 3500);
      }

      function submitViaIframe(data) {
        const iframe = document.getElementById("hidden_iframe");
        const tempForm = document.createElement("form");
        tempForm.action = WEB_APP_URL;
        tempForm.method = "POST";
        tempForm.target = iframe.name;
        tempForm.style.display = "none";
        Object.keys(data).forEach((k) => {
          const i = document.createElement("input");
          i.type = "hidden";
          i.name = k;
          i.value = data[k];
          tempForm.appendChild(i);
        });
        document.body.appendChild(tempForm);
        tempForm.submit();
        setTimeout(() => {
          document.body.removeChild(tempForm);
          showSuccess();
        }, 1200);
      }

      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        const submissionEl = document.getElementById("submissionId");
        if (!submissionEl.value) {
          submissionEl.value =
            Date.now() + "-" + Math.random().toString(36).slice(2, 9);
        }

        if (!highlightRequiredFields()) return;

        const data = gatherData();

        showLoading();

        const qs = new URLSearchParams(data).toString();
        const fullUrl = WEB_APP_URL + "?" + qs;

        if (fullUrl.length > 2000) {
          submitViaIframe(data);
          return;
        }

        try {
          const res = await fetch(fullUrl, { method: "GET", mode: "cors" });
          const r = await res.json();
          if (r && r.status === "success") {
            showSuccess();
          } else {
            submitViaIframe(data);
          }
        } catch (err) {
          submitViaIframe(data);
        }
      });
    </script>
  </body>
</html>
